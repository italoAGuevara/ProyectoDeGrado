<div class="row">
  <div class="col-12 col-lg-8 mx-auto">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="page-title">Configuración</h1>
    </div>

    @if (message) {
      <div 
        class="alert" 
        [ngClass]="{'alert-success': messageType === 'success', 'alert-danger': messageType === 'error'}"
        role="alert">
        {{ message }}
      </div>
    }

    <div class="card mb-4 border-0 shadow-sm">
      <div class="card-body p-4">
        <h5 class="card-title fw-bold mb-3">Autenticación</h5>
        <div class="form-check form-switch mb-3">
          <input 
            class="form-check-input" 
            type="checkbox" 
            role="switch" 
            id="authSwitch" 
            [(ngModel)]="requireAuth"
            (change)="saveAuthSettings()">
          <label class="form-check-label" for="authSwitch">
            Requerir contraseña al iniciar sesión
          </label>
        </div>
        <p class="text-muted small">
          Si se desactiva, cualquier persona con acceso a la aplicación podrá administrar los trabajos y destinos.
        </p>
      </div>
    </div>

    @if (requireAuth) {
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
          <h5 class="card-title fw-bold mb-3">Cambiar contraseña</h5>
          <form (submit)="changePassword(); $event.preventDefault()">
            <div class="mb-3">
              <label for="oldPassword" class="form-label">Contraseña actual</label>
              <input 
                type="password" 
                class="form-control" 
                id="oldPassword" 
                [(ngModel)]="oldPassword" 
                name="oldPassword"
                required>
            </div>
            <div class="mb-3">
              <label for="newPassword" class="form-label">Nueva contraseña</label>
              <input 
                type="password" 
                class="form-control" 
                id="newPassword" 
                [(ngModel)]="newPassword" 
                name="newPassword"
                placeholder="Mínimo 8 caracteres"
                minlength="8"
                required>
            </div>
            <div class="mb-3">
              <label for="confirmPassword" class="form-label">Confirmar nueva contraseña</label>
              <input 
                type="password" 
                class="form-control" 
                id="confirmPassword" 
                [(ngModel)]="confirmPassword" 
                name="confirmPassword"
                required>
            </div>
            <div class="d-flex justify-content-end">
              <button type="submit" class="btn btn-modal-save">
                <span class="btn-modal-icon" aria-hidden="true">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                </span>
                Actualizar contraseña
              </button>
            </div>
          </form>
        </div>
      </div>
    }
  </div>
</div>
